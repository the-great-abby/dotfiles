#!/bin/bash
# GTD Brain MOC Starter - Create important starter MOCs

# Load GTD config
GTD_CONFIG_FILE="$HOME/.gtd_config"
if [[ -f "$HOME/code/dotfiles/zsh/.gtd_config" ]]; then
  GTD_CONFIG_FILE="$HOME/code/dotfiles/zsh/.gtd_config"
elif [[ -f "$HOME/code/personal/dotfiles/zsh/.gtd_config" ]]; then
  GTD_CONFIG_FILE="$HOME/code/personal/dotfiles/zsh/.gtd_config"
fi

if [[ -f "$GTD_CONFIG_FILE" ]]; then
  source "$GTD_CONFIG_FILE"
fi

# Colors
CYAN='\033[0;36m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BOLD='\033[1m'
NC='\033[0m'

# Starter MOCs with descriptions
declare -A STARTER_MOCS=(
  ["Areas of Responsibility"]="Organize notes by life areas (Health, Finance, Relationships, etc.)"
  ["Active Projects"]="Track all current projects in one place"
  ["Learning & Study"]="Organize learning materials, courses, and study notes"
  ["Health & Wellness"]="Track workouts, nutrition, medication, and health goals"
  ["Kubernetes Learning"]="Centralize Kubernetes/CKA learning materials"
  ["GTD System"]="Document GTD workflows and best practices"
  ["Work & Career"]="Organize professional development and work-related notes"
  ["Daily Reflections"]="Connect daily notes and extract insights over time"
  ["Resources & References"]="Organize useful resources for later reference"
  ["Ideas & Someday/Maybe"]="Capture ideas and future possibilities"
)

# Show starter MOCs menu
show_starter_menu() {
  clear
  echo ""
  echo -e "${BOLD}${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
  echo -e "${BOLD}${CYAN}ğŸ—ºï¸  Starter MOCs - Important Maps of Content${NC}"
  echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
  echo ""
  echo "Create important MOCs to get started with your Second Brain."
  echo ""
  echo "Recommended Starter MOCs:"
  echo ""
  
  local i=1
  for moc_name in "${!STARTER_MOCS[@]}"; do
    local description="${STARTER_MOCS[$moc_name]}"
    echo -e "${GREEN}$i)${NC} ${BOLD}$moc_name${NC}"
    echo "   $description"
    echo ""
    ((i++))
  done
  
  echo -e "${GREEN}11)${NC} Create all recommended MOCs"
  echo -e "${GREEN}12)${NC} Create top 5 essential MOCs"
  echo ""
  echo -e "${YELLOW}0)${NC} Back"
  echo ""
  echo -n "Choose: "
}

# Create a single MOC
create_moc() {
  local moc_name="$1"
  
  if [[ -z "$moc_name" ]]; then
    echo "âŒ MOC name required"
    return 1
  fi
  
  echo ""
  echo "Creating MOC: $moc_name"
  gtd-brain-moc create "$moc_name"
  
  if [[ $? -eq 0 ]]; then
    echo "âœ“ Created: $moc_name"
    echo ""
    echo "ğŸ’¡ Next steps:"
    echo "  â€¢ Add notes: gtd-brain-moc add \"$moc_name\" <note-path>"
    echo "  â€¢ Auto-populate: gtd-brain-moc auto \"$moc_name\" <tag>"
    echo "  â€¢ View: gtd-brain-moc view \"$moc_name\""
    echo ""
  fi
}

# Create top 5 essential MOCs
create_top_5() {
  echo ""
  echo -e "${BOLD}${CYAN}Creating Top 5 Essential MOCs${NC}"
  echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
  echo ""
  
  local top_5=(
    "Areas of Responsibility"
    "Active Projects"
    "Learning & Study"
    "Health & Wellness"
    "Daily Reflections"
  )
  
  for moc_name in "${top_5[@]}"; do
    create_moc "$moc_name"
  done
  
  echo ""
  echo "âœ“ Top 5 essential MOCs created!"
  echo ""
  echo "ğŸ“š Learn more: ~/code/dotfiles/zsh/STARTER_MOCS_GUIDE.md"
  echo ""
}

# Create all recommended MOCs
create_all() {
  echo ""
  echo -e "${BOLD}${CYAN}Creating All Recommended MOCs${NC}"
  echo -e "${CYAN}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
  echo ""
  
  for moc_name in "${!STARTER_MOCS[@]}"; do
    create_moc "$moc_name"
  done
  
  echo ""
  echo "âœ“ All recommended MOCs created!"
  echo ""
  echo "ğŸ“š Learn more: ~/code/dotfiles/zsh/STARTER_MOCS_GUIDE.md"
  echo ""
}

# Main function
main() {
  while true; do
    show_starter_menu
    read choice
    
    case "$choice" in
      1)
        create_moc "Areas of Responsibility"
        echo "Press Enter to continue..."
        read
        ;;
      2)
        create_moc "Active Projects"
        echo "Press Enter to continue..."
        read
        ;;
      3)
        create_moc "Learning & Study"
        echo "Press Enter to continue..."
        read
        ;;
      4)
        create_moc "Health & Wellness"
        echo "Press Enter to continue..."
        read
        ;;
      5)
        create_moc "Kubernetes Learning"
        echo "Press Enter to continue..."
        read
        ;;
      6)
        create_moc "GTD System"
        echo "Press Enter to continue..."
        read
        ;;
      7)
        create_moc "Work & Career"
        echo "Press Enter to continue..."
        read
        ;;
      8)
        create_moc "Daily Reflections"
        echo "Press Enter to continue..."
        read
        ;;
      9)
        create_moc "Resources & References"
        echo "Press Enter to continue..."
        read
        ;;
      10)
        create_moc "Ideas & Someday/Maybe"
        echo "Press Enter to continue..."
        read
        ;;
      11)
        create_all
        echo "Press Enter to continue..."
        read
        ;;
      12)
        create_top_5
        echo "Press Enter to continue..."
        read
        ;;
      0)
        exit 0
        ;;
      *)
        echo "Invalid choice"
        sleep 1
        ;;
    esac
  done
}

# Show usage
show_usage() {
  cat <<EOF
Usage: gtd-brain-moc-starter

Interactive menu to create important starter MOCs.

This command helps you create the most important Maps of Content (MOCs)
to get started with your Second Brain system.

Recommended starter MOCs:
  1. Areas of Responsibility
  2. Active Projects
  3. Learning & Study
  4. Health & Wellness
  5. Daily Reflections

See also: ~/code/dotfiles/zsh/STARTER_MOCS_GUIDE.md

EOF
}

# Handle arguments
case "${1:-}" in
  --help|-h)
    show_usage
    exit 0
    ;;
  "")
    main
    ;;
  *)
    echo "Unknown option: $1"
    show_usage
    exit 1
    ;;
esac

